#+title: Example 1
#+author: Alexander E. Zarebski
#+Time-stamp: <Last modified: 2022-04-14 15:29:28>

The details of the simulation of this data set are [[file:../simulating-data/readme.org::*Example 1][here]]. The input data is in
=data/= and there is an XML for using BDSky (serial) and TimTam to analyse this
data in =xml/=. The script =src/make-posterior-plots.R= produces the summary in
Table [[tbl:r0-estimates]]. Figure [[fig:prev-est]] shows the posterior estimate of the
prevalence obtained by the TimTam model. Figure [[fig:r0-est]] shows a comparison of
the R-nought estimates from each model.

A script demonstrating how to run this example is included [[runner-script][below]].

#+name: tbl:r0-estimates
#+caption:  Summary of R-nought estimates
| Model          | Estimate (CrI \(95\%\))  |
|----------------+--------------------------|
| BDSky (serial) | \(1.52\) \((1.44,1.61)\) |
| TimTam         | \(1.59\) \((1.51,1.67)\) |

#+caption: Estimate of prevalence
#+name: fig:prev-est
#+attr_org: :width 500px
#+attr_html: :width 400px
[[./out/prevalence-estimate.png]]

#+caption: Estimates of R-nought
#+name: fig:r0-est
#+attr_org: :width 500px
#+attr_html: :width 400px
[[./out/r-naught-comparison.png]]

#+name: runner-script
#+begin_src sh :tangle main.sh
#!/usr/bin/env sh

CHAIN_LENGTH=100000
BEAST_JAR=../../../../beast2/build/dist/beast.jar
BEAST_CLASS=beast.app.beastapp.BeastMain

EXTRA_ARGS="-overwrite -seed 1 -D chainLength=$CHAIN_LENGTH"
BEAST_CMD="java -cp $BEAST_JAR $BEAST_CLASS $EXTRA_ARGS"

$BEAST_CMD xml/bdsky-serial.xml
mv ex1-bdsky-serial.log out/

$BEAST_CMD xml/timtam.xml
mv ex1-timtam.log out/

Rscript src/make-posterior-plots.R
#+end_src

#  LocalWords:  TimTam CrI
