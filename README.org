#+title: TimTam
#+author: Alexander E. Zarebski

This repository is an attempt to implement the [[https://github.com/aezarebski/timtam][TimTam]] likelihood (described in
the PLOS Computational Biology [[https://doi.org/10.1371/journal.pcbi.1009805][paper]]) as a BEAST2 package. There are [[*Vignettes][vignettes]]
demonstrating how to use this.

* Remaining tasks and open problems

1. Avoid using the same package paths
2. Re-run the vignettes using XML generated by Beauti rather than the hand
   crafted versions currently given.
   - [X] Fixed tree with \(\rho\)-sample
   - [ ] Fixed tree without \(\rho\)-sample
   - [ ] Estimated tree with \(\rho\)-sample
   - [ ] Estimated tree without \(\rho\)-sample
3. Use proper dates on the nodes and point process to avoid needing to
   pre-compute these for the XML
   - The [[https://cran.r-project.org/web/packages/phangorn/index.html][phangorn]] package can simulate sequences on a tree.
   - There is a Taming the Beast [[https://taming-the-beast.org/tutorials/Molecular-Dating-Tutorial/][tutorial]] which looks at dates on nodes.
4. Include the capability to parameterise this in terms of \(R_{0}\).
5. Support heterogeneous rates
6. Include support for occurrence times in Beauti.

* Vignettes

- [[file:./doc/vignettes/fixed-tree-with-rho/README.org][Fixed tree with \(\rho\)-sample]]
- [[file:./doc/vignettes/fixed-tree-with-nu/README.org][Fixed tree with \(\nu\)-sample]]
- [[file:./doc/vignettes/estimated-tree-with-rho/README.org][Estimated tree with \(\rho\)-sample]]
- [[file:./doc/vignettes/fixed-tree-without-rho/README.org][Fixed tree without \(\rho\)-sample]]
- [[file:./doc/vignettes/estimated-tree-without-rho/README.org][Estimated tree without \(\rho\)-sample]]

* Structure

Figure [[example-dag]] shows an example of how the classes provided by the package
fit together to define a model. The =RootLength= is really a =RealParameter= but
this has not been given its own class yet.

#+name: example-dag
#+attr_org: :width 500
[[./example-dag.png]]
