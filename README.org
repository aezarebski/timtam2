#+title: TimTam
#+author: Alexander E. Zarebski

This repository is an attempt to implement the [[https://github.com/aezarebski/timtam][TimTam]] likelihood (described in
the PLOS Computational Biology [[https://doi.org/10.1371/journal.pcbi.1009805][paper]]) as a BEAST2 package. There are [[file:./doc/vignettes/readme.org::*Vignettes][vignettes]]
demonstrating how to use this. There is also a [[file:./doc/vignettes/readme.org::*Glossary][glossary]] for definitions specific
to TimTam.

* Installation

The following is an example of how to compile this package and install it so
BEAST2 can find it.

#+begin_example
$ ant
...
$ ls dist/timtam.*.zip
dist/timtam.v0.1.0.zip
$ cd ~/.beast/2.6/
$ mkdir timtam
$ cd timtam
$ unzip -o <path/to/timtam.v0.1.0.zip>
...
$ java-cp <path/to/beast.jar> beast.app.beauti.Beauti
#+end_example

_Don't forget to clear the Class Path in Beauti before looking for the package!_

* Structure

Figure [[example-dag]] shows an example of how the classes provided by the package
fit together to define a model. The =RootLength= is really a =RealParameter= but
this has not been given its own class yet.

#+name: example-dag
#+attr_org: :width 500
[[./example-dag.png]]

* Remaining tasks and open problems

1. Use proper dates on the nodes and point process to avoid needing to
   pre-compute these for the XML
   - The [[https://cran.r-project.org/web/packages/phangorn/index.html][phangorn]] package can simulate sequences on a tree.
   - There is a Taming the Beast [[https://taming-the-beast.org/tutorials/Molecular-Dating-Tutorial/][tutorial]] which looks at dates on nodes.
2. Support heterogeneous rates
3. The [[file:./doc/vignettes/example-1/xml/bdsky-serial.xml][Example 1 XML]] still uses the R-nought parameterisation, but the Example 2
   XML shows that it is easy to move over to the canonical parameterisation.
4. The [[*Structure][Structure]] section below is massively out of date.
